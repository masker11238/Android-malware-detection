import os

apkPath = "D:/apk/"

folderlist1 = os.listdir(apkPath)


for i in range(len(folderlist1)):  
    filelist1 = apkPath + folderlist1[i]
    folderlist2=os.listdir(filelist1)
    for j in range(len(folderlist2)):
        filelist2=filelist1 +"/"+ folderlist2[j]
        folderlist3=os.listdir(filelist2)
        for k in range(len(folderlist3)):
            filelist3 = filelist2 + "/"+folderlist3[k]
            folderlist4 = os.listdir(filelist3)
            for l in range(len(folderlist4)):
                filelist4=filelist3 + "/"+folderlist4[l]
                folderlist5=os.listdir(filelist4)
                festlist = os.listdir(filelist4)
                permissionname ="permission-{0}-{1}-{2}-{3}.txt".format(i,j,k,l)
                intentname = "intent-{0}-{1}-{2}-{3}.txt".format(i,j,k,l)

                sourcepath=filelist4 + "/" +"AndroidManifest.xml"
                permissionpath=filelist4 + "/" +permissionname
                intentpath = filelist4 + "/" + intentname


                f1 = open(sourcepath, "r",encoding='UTF-8')

                for line in f1.readlines(): 
                    line = line.strip()
                    line = line.strip("<").strip("/>")

                    if "uses-permission" in line:
                        f2 = open(permissionpath, "a",encoding='UTF-8')
                        f2.write(line + "\n")
                        f2.close()
                    if "action android:name" in line:
                        f3 = open(intentpath, "a",encoding='UTF-8')
                        f3.write(line + "\n")
                        f3.close()
                    if "category android:name" in line:
                        f3 = open(intentpath, "a",encoding='UTF-8')
                        f3.write(line + "\n")
                        f3.close()


print("Complete!")
