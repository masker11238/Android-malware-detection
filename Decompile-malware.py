import os
# Storage path of apk
apkPath = "E:/1/"
# Apk is divided by category, and the category of each APK is obtained
folderlist1 = os.listdir(apkPath)

# The path stores the files obtained by decompilating APK. Remember to add at the end/
outputPath = "E:/1/"

# After decompiling APK, it is stored according to the original category
for i in range(len(folderlist1)):  # Get each category under APK folder
    filelist1 = apkPath + folderlist1[i]
    folderlist2=os.listdir(filelist1)
    for j in range(len(folderlist2)):
        filelist2=filelist1 +"/"+ folderlist2[j]
        folderlist3=os.listdir(filelist2)
        for k in range(len(folderlist3)):
            filelist3 = filelist2 + "/"+folderlist3[k]
            folderlist4 = os.listdir(filelist3)

            apklist = os.listdir(filelist3)


            category_output =filelist3 # Output path list

            if not os.path.exists(category_output):  # If the output path does not exist, create a path
                os.makedirs(category_output)


            for APK in apklist:
                portion = os.path.splitext(APK)  # Divide APK files according to their file names and suffixes
                apkoutPath = os.path.join(category_output, portion[0])  # The APK file name is stored in the portion
                APK = os.path.join(filelist3, APK)
        # if not os.path.exists(apkoutPath):
        #    os.makedirs(apkoutPath)
                cmd = "apktool d {0} -o {1}".format(APK, apkoutPath)  # File naming rules after Decompilation
                os.chdir("D:/apktool")
                os.system(cmd)

print("Complete!")

