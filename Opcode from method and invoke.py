#Extract the Opcede in the smail file related to ".Method" and "Opcode "invlke static"

import os


sourcepath="D:/apk/malware/0-PremiumSMS/BeanBot/0-0-0-0/smali"
APIpath="D:/apk/benign/0-PremiumSMS/BeanBot/0-0-0-0/smali/smali.txt"
rule = ".smali"
list = []
for fpathe, dirs, fs in os.walk(sourcepath):  
    for f in fs:
        filename = os.path.join(fpathe, f)
        if filename.endswith(rule):
            list.append(filename)
l = len(list)

for i in range(l):
    f1 = open(list[i], "r",encoding='UTF-8')

    for line in f1.readlines(): 
        line = line.strip()


        if ".method" in line:
            line=line.strip(" ")
            f2 = open(APIpath, "a",encoding='UTF-8')
            f2.write(line[-1] + "\n")
            f2.close()
        if "invoke-static" in line:
            f3 = open(APIpath, "a",encoding='UTF-8')
            f3.write(line + "\n")
            f3.close()
print("完成")